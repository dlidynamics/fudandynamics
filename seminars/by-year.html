---
layout: default
title: Seminars by Year
permalink: /seminars/by-year.html
---

<h1>Seminars</h1>

<nav class="year-nav" style="margin: 0.75rem 0 1.25rem 0;">
  <strong style="margin-right: .5rem;">Years:</strong>
  {%- assign all_sorted = site.seminars | sort: "datetime" -%}
  {%- assign grouped = all_sorted | group_by_exp: "e", "e.datetime | date: '%Y'" -%}
  {%- assign years = grouped | map: "name" | sort | reverse -%}
  {%- for y in years -%}
    <a href="/seminars/by-year.html?y={{ y }}" style="margin-right: .5rem; text-decoration: none;">
      {{ y }}
    </a>
  {%- endfor -%}
</nav>

<div id="year-title" style="margin: .5rem 0 1rem 0; font-weight: 600;"></div>
<ul id="seminar-list" class="seminar-list"></ul>

<script>
(function() {
  // 读取 URL 参数 ?y=YYYY
  const params = new URLSearchParams(window.location.search);
  const year = params.get('y');

  // 嵌入所有 seminars 的数据（仅提取需要的字段，避免页面过大）
  const DATA = {{ site.seminars | map: "title" | jsonify }}; // dummy line to keep GitHub Pages from stripping collection
})();
</script>

<script>
(function() {
  const params = new URLSearchParams(window.location.search);
  const year = params.get('y');

  // 将所有 seminars 序列化为简单 JSON（挑必要字段）
  const seminars = [
    {% assign all = site.seminars | sort: "datetime" %}
    {% for s in all %}
      {
        "title": {{ s.title | jsonify }},
        "speaker": {{ s.speaker | default: "" | jsonify }},
        "place": {{ s.place | default: "" | jsonify }},
        "abstract": {{ s.abstract | default: "" | jsonify }},
        "url": {{ s.url | default: s.permalink | jsonify }},
        "iso": "{{ s.datetime | date: '%Y-%m-%dT%H:%M:%S%z' }}",
        "date_human": "{{ s.datetime | date: '%A, %d %b %Y, %H:%M (%Z)' }}",
        "anchor": "{{ s.datetime | date: '%Y-%m-%d' }}"
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ];

  // 过滤出该年份
  const list = (year ?
    seminars.filter(it => it.iso.slice(0,4) === year) :
    seminars
  );

  // 渲染标题
  const titleEl = document.getElementById('year-title');
  if (year) {
    titleEl.textContent = `Year: ${year}`;
  } else {
    titleEl.textContent = 'All years';
  }

  // 渲染列表（按时间升序，已经是升序；如果你想再保险，也可在此排序一次）
  const ul = document.getElementById('seminar-list');
  ul.innerHTML = '';

  if (list.length === 0) {
    ul.insertAdjacentHTML('beforeend', '<li>No seminars in this year.</li>');
    return;
  }

  for (const s of list) {
    const li = document.createElement('li');
    li.id = s.anchor;
    li.innerHTML = `
      <div class="title">${s.title}</div>
      <div class="meta">
        ${s.date_human}
        ${s.place ? ' · ' + s.place : ''}
        ${s.speaker ? ' · ' + s.speaker : ''}
      </div>
      ${s.abstract ? `<p>${s.abstract}</p>` : ''}
      ${s.url ? `<a href="${s.url}">Details</a>` : ''}
    `;
    ul.appendChild(li);
  }
})();
</script>
